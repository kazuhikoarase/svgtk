"use strict";const w=require("./core.js"),Q=require("./svgtk.js"),y=require("./math.js"),v=require("./mat4.js"),z=Q.pathBuilder,b=function(t,h){return Math.sqrt(h*h/(t*t)-1)},T=function(t,h){return function(s){return[t*Math.cos(s+h)+t*s*Math.sin(s+h),t*Math.sin(s+h)-t*s*Math.cos(s+h)]}},I={n:3,dt:.05},A=function(t){t=w.extend({m:20,z:20,a:Math.PI*20/180},t);const h=t.m,s=t.z,d=s*h,e=d-2.5*h,c=d+2*h;let n=d*Math.cos(t.a)/2;n=Math.max(n,e/2);const u=Math.PI*2*0,i=b(n,c/2),f=T(n,0)(b(n,d/2)),M=-Math.atan(f[1]/f[0]),l=z();let a,r,g=0;for(let x=0;x<s;x+=1){for(r=y.default.getQuadPoints({fn:T(n,M+g),min:u,max:i,n:I.n,dt:I.dt}),a=0;a<r.length;a+=1)a==0?x==0&&l.moveTo(r[a][0],r[a][1]):l.quadTo(r[a][0],r[a][1],r[a][2],r[a][3]);for(g+=Math.PI/s,r=y.default.getQuadPoints({fn:T(n,-M+g),min:-i,max:u,n:I.n,dt:I.dt}),a=0;a<r.length;a+=1)a==0?l.lineTo(r[a][0],r[a][1]):l.quadTo(r[a][0],r[a][1],r[a][2],r[a][3]);g+=Math.PI/s,function(){let m;const q=e/2,P=[];m=Math.PI/s*(x*2+1)-M,P.push([q*Math.cos(m),q*Math.sin(m)]),m=Math.PI/s*(x*2+1.5),P.push([q*Math.cos(m),q*Math.sin(m)]),m=Math.PI/s*(x*2+2)+M,P.push([q*Math.cos(m),q*Math.sin(m)]),m=Math.PI/s*(x*2+2)+M,P.push([n*Math.cos(m),n*Math.sin(m)]),l.quadTo(P[0][0],P[0][1],P[1][0],P[1][1]),l.quadTo(P[2][0],P[2][1],P[3][0],P[3][1])}()}return l.close(),{m:h,z:s,d,d1:e,d2:c,r:n,tMin:u,tMax:i,t0:M,path:l.build()}},G=function(t){t=w.extend({m:20,z:20,a:Math.PI*20/180},t);const h=t.m,s=t.z,d=s*h,e=d+2.5*h,c=d-2*h;let n=d*Math.cos(t.a)/2;n=Math.max(n,c/2);const u=Math.PI*2*0,i=b(n,e/2),f=T(n,0)(b(n,d/2)),M=-Math.atan(f[1]/f[0]),l=z();let a,r,g=0;for(let x=0;x<s;x+=1){for(r=y.default.getQuadPoints({fn:T(n,-M+g),min:-i,max:u,n:I.n,dt:I.dt}),a=0;a<r.length;a+=1)a==0?x==0&&l.moveTo(r[a][0],r[a][1]):l.quadTo(r[a][0],r[a][1],r[a][2],r[a][3]);for(g+=Math.PI/s,r=y.default.getQuadPoints({fn:T(n,M+g),min:u,max:i,n:I.n,dt:I.dt}),a=0;a<r.length;a+=1)a==0?l.lineTo(r[a][0],r[a][1]):l.quadTo(r[a][0],r[a][1],r[a][2],r[a][3]);g+=Math.PI/s,function(){let m;const q=e/2;m=Math.PI/s*(x*2+1.5)-M,l.lineTo(q*Math.cos(m),q*Math.sin(m))}()}return l.close(),{m:h,z:s,d,d1:e,d2:c,r:n,tMin:u,tMax:i,t0:M,path:l.build()}},O=function(t){t=w.extend({r1:100,r2:200,r3:10,r4:10,w:10,a:Math.PI/2,offsetAngle:0},t);const h=[];(function(){const e=Math.asin((t.w/2+t.r3)/(t.r1+t.r3)),c=t.r1*Math.cos(e),o=t.r1*Math.sin(e),n=Math.atan2(o,c);h.push({order:0,cx:0,cy:0,r:t.r1,t0:t.a-n,t1:n})})(),function(){let e;(function(c){const o=t.r1*Math.cos(c),n=t.r1*Math.sin(c),u=(t.r1+t.r3)*Math.cos(c),i=(t.r1+t.r3)*Math.sin(c),f=Math.atan2(n-i,o-u),M=Math.atan2(t.w/2-i,0);h.push({order:1,cx:u,cy:i,r:t.r3,t0:f,t1:M}),e=M-f})(Math.asin((t.w/2+t.r3)/(t.r1+t.r3))),function(c){const o=t.r1*Math.cos(c),n=t.r1*Math.sin(c),u=(t.r1+t.r3)*Math.cos(c),i=(t.r1+t.r3)*Math.sin(c),f=Math.atan2(n-i,o-u),M=f-e;h.push({order:5,cx:u,cy:i,r:t.r3,t0:M,t1:f})}(t.a-Math.asin((t.w/2+t.r3)/(t.r1+t.r3)))}(),function(){const e=Math.asin((t.w/2+t.r4)/(t.r2-t.r4)),c=t.r2*Math.cos(e),o=t.r2*Math.sin(e),n=Math.atan2(o,c);h.push({order:3,cx:0,cy:0,r:t.r2,t0:n,t1:t.a-n})}(),function(){let e;(function(c){const o=t.r2*Math.cos(c),n=t.r2*Math.sin(c),u=(t.r2-t.r4)*Math.cos(c),i=(t.r2-t.r4)*Math.sin(c),f=Math.atan2(t.w/2-i,0),M=Math.atan2(n-i,o-u);h.push({order:2,cx:u,cy:i,r:t.r4,t0:f,t1:M}),e=M-f})(Math.asin((t.w/2+t.r4)/(t.r2-t.r4))),function(c){const o=t.r2*Math.cos(c),n=t.r2*Math.sin(c),u=(t.r2-t.r4)*Math.cos(c),i=(t.r2-t.r4)*Math.sin(c),f=Math.atan2(n-i,o-u),M=f+e;h.push({order:4,cx:u,cy:i,r:t.r4,t0:f,t1:M})}(t.a-Math.asin((t.w/2+t.r4)/(t.r2-t.r4)))}(),h.sort(function(e,c){return e.order<c.order?-1:1});const s=v().rotateZ(t.offsetAngle),d=z();return h.forEach(function(e){const c=function(n){return[e.r*Math.cos(n)+e.cx,e.r*Math.sin(n)+e.cy]},o=y.default.getQuadPoints({fn:c,min:e.t0,max:e.t1,n:4,dt:.05});for(let n=0;n<o.length;n+=1)o[n]=s.transform([o[n][0],o[n][1]]).concat(s.transform([o[n][2],o[n][3]])),n==0?e.order==0?d.moveTo(o[n][0],o[n][1]):(e.order==2||e.order==5)&&d.lineTo(o[n][0],o[n][1]):d.quadTo(o[n][0],o[n][1],o[n][2],o[n][3])}),d.close(),{path:d.build()}},_={createGear:A,createInnerGear:G,createPie:O};module.exports=_;
//# sourceMappingURL=gear-util.js.map
