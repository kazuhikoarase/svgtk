{"version":3,"file":"core.mjs","sources":["../src/core.ts"],"sourcesContent":["//\n// core\n//\n// Copyright (c) 2025 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//  http://www.opensource.org/licenses/mit-license.php\n//\n\ntype EventListener = (event : {type : string}, detail : any) => void;\n\nexport const extend = function(o : any, ...args : any[]) {\n  for (let i = 0; i < args.length; i += 1) {\n    const a = args[i];\n    for (let k in a) {\n      o[k] = a[k];\n    }\n  }\n  return o;\n};\n\nexport const eventTarget = function() {\n  let listenersMap : { [type : string] : EventListener[]} | null  = null;\n  return {\n    trigger: function(type : string, detail : any) {\n      if (!listenersMap) return;\n      const listeners = listenersMap[type];\n      if (!listeners) return;\n      const event = { type : type };\n      listeners.forEach(function(l) {\n        l(event, detail);\n      });\n    },\n    on: function(type : string, l : EventListener) {\n      listenersMap = (listenersMap || (listenersMap = {}) );\n      (listenersMap[type] || (listenersMap[type] = []) ).push(l);\n    },\n    off: function(type : string, l : EventListener) {\n      if (!listenersMap) return;\n      const listeners = listenersMap[type];\n      if (!listeners) return;\n      listenersMap[type] = listeners.filter(function(_l) {\n        return _l != l;\n      });\n    }\n  };\n};\n"],"names":["extend","o","args","i","a","k","eventTarget","listenersMap","type","detail","listeners","event","l","_l"],"mappings":"AAaO,MAAMA,IAAS,SAASC,MAAYC,GAAc;AACvD,WAASC,IAAI,GAAGA,IAAID,EAAK,QAAQC,KAAK,GAAG;AACvC,UAAMC,IAAIF,EAAKC,CAAC;AAChB,aAASE,KAAKD;AACZ,MAAAH,EAAEI,CAAC,IAAID,EAAEC,CAAC;AAAA,EACZ;AAEF,SAAOJ;AACT,GAEaK,IAAc,WAAW;AACpC,MAAIC,IAA8D;AAClE,SAAO;AAAA,IACL,SAAS,SAASC,GAAeC,GAAc;AAC7C,UAAI,CAACF,EAAc;AACnB,YAAMG,IAAYH,EAAaC,CAAI;AACnC,UAAI,CAACE,EAAW;AAChB,YAAMC,IAAQ,EAAE,MAAAH,EAAA;AAChB,MAAAE,EAAU,QAAQ,SAASE,GAAG;AAC5B,QAAAA,EAAED,GAAOF,CAAM;AAAA,MAAA,CAChB;AAAA,IAAA;AAAA,IAEH,IAAI,SAASD,GAAeI,GAAmB;AAC7C,MAAAL,IAAgBA,MAAiBA,IAAe,MAC/CA,EAAaC,CAAI,MAAMD,EAAaC,CAAI,IAAI,CAAA,IAAM,KAAKI,CAAC;AAAA,IAAA;AAAA,IAE3D,KAAK,SAASJ,GAAeI,GAAmB;AAC9C,UAAI,CAACL,EAAc;AACnB,YAAMG,IAAYH,EAAaC,CAAI;AACnC,MAAKE,MACLH,EAAaC,CAAI,IAAIE,EAAU,OAAO,SAASG,GAAI;AACjD,eAAOA,KAAMD;AAAA,MAAA,CACd;AAAA,IAAA;AAAA,EACH;AAEJ;"}