{"version":3,"file":"math.js","sources":["../src/math.ts"],"sourcesContent":["//\n// math\n//\n// Copyright (c) 2025 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//  http://www.opensource.org/licenses/mit-license.php\n//\n\nimport { extend } from './core';\n\nexport const d2r = (deg : number) => deg / 180 * Math.PI;\nexport const r2d = (rad : number) => rad / Math.PI * 180;\n\nconst inv = function(m : number[]) {\n  const det = m[0] * m[3] - m[1] * m[2];\n  return [m[3] / det, -m[1] / det, -m[2] / det, m[0] / det];\n};\n\nexport const getCrossPoint = function(a : number[], va : number[], b : number[], vb : number[]) {\n  const m = inv([va[0], -vb[0], va[1], -vb[1]]);\n  const v = [b[0] - a[0], b[1] - a[1]];\n  //const st = [m[0] * v[0] + m[1] * v[1], m[2] * v[0] + m[3] * v[1]];\n  //return [a[0] + va[0] * st[0], a[1] + va[1] * st[0]];\n  const s = m[0] * v[0] + m[1] * v[1];\n  return [a[0] + va[0] * s, a[1] + va[1] * s];\n};\n\nexport interface QuadPointsOpts {\n  fn : (t : number) => number[];\n  min : number;\n  max : number;\n  n : number;\n  dt : number;\n}\n\nexport const getQuadPoints = function(opts : QuadPointsOpts) {\n\n  opts = extend({\n    fn : function(t : number) { return [t, t] },\n    min : 0, max : 1, n : 10, dt : 0.1\n  }, opts);\n\n  // delta points\n  const points = [];\n  !function() : any {\n    for (let i = 0; i <= opts.n; i += 1) {\n      const t = (opts.max - opts.min) * i / opts.n + opts.min;\n      points.push([opts.fn(t), opts.fn(t + opts.dt)]);\n    }\n  }();\n\n  const quadPoints = [];\n  !function() : any {\n    for (let i = 0; i < opts.n; i += 1) {\n      let z = getCrossPoint(\n        [points[i][0][0],\n         points[i][0][1]],\n        [points[i][1][0] - points[i][0][0],\n         points[i][1][1] - points[i][0][1]],\n        [points[i + 1][0][0],\n         points[i + 1][0][1]],\n        [points[i + 1][1][0] - points[i + 1][0][0],\n         points[i + 1][1][1] - points[i + 1][0][1]]\n      );\n      if (i == 0) {\n        quadPoints.push([points[i][0][0], points[i][0][1]]);\n        \n      }\n      if (isNaN(z[0]) ) {\n        z = points[i][0];\n      }\n      quadPoints.push([z[0], z[1], points[i + 1][0][0], points[i + 1][0][1]]);\n    }\n  }();\n  const qp : any = quadPoints;\n  qp.points = points;\n  return quadPoints;\n};\n"],"names":["d2r","deg","r2d","rad","inv","m","det","getCrossPoint","a","va","b","vb","v","s","getQuadPoints","opts","extend","t","points","i","quadPoints","z","qp"],"mappings":"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"}